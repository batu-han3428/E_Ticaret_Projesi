@model List<urunKategorileri>

<div class="row">
    <div class="col-md-6">
        <fieldset>
            <legend>Kategori Alanları</legend>
            @{
                if (Model.Count == 0)
                {
                    <div id="kategoriAlanlariYaziAlan">
                        <span>Kayıtlı kategori alanı bulunmamaktadır. Ürünlerinizi listelemek için lütfen kategori alanı giriniz.</span>
                    </div>
                    <div id="kategoriAlanlariButonAlan">
                        <button class="btn btn-secondary" id="kategoriAlanlariButon" data-bs-target="#kategoriAlanlariModal" data-bs-toggle="modal">
                            <div>
                                <span id="kategoriAlanlariButonYazi">Kategori Alanı Ekle</span>
                            </div>
                            <div>
                                <i class="bi bi-file-earmark-plus-fill" id="kategoriAlanlariButonIcon"></i>
                            </div>
                        </button>
                    </div>
                }
                else
                {
                    <div class="urunKategorileriDivAlan">
                        @foreach (var item in Model)
                        {
                            if (item.urunKategorileriUstId == 0)
                            {

                            <div class="urunKategorileriAlanAdlari">
                                <span>@item.urunKategorileriKategoriAdi</span>
                                <hr />
                            </div>

                            }

                        }
                    </div>
                    <div id="kategoriAlanlariButonAlan">
                        <button class="btn btn-secondary" id="kategoriAlanlariButon" data-bs-target="#kategoriAlanlariModal" data-bs-toggle="modal">
                            <div>
                                <span id="kategoriAlanlariButonYazi">Kategori Alanı Ekle</span>
                            </div>
                            <div>
                                <i class="bi bi-file-earmark-plus-fill" id="kategoriAlanlariButonIcon"></i>
                            </div>
                        </button>
                    </div>
                }
            }

        </fieldset>
    </div>
    <div class="col-md-6">
        <fieldset>
            <legend>Kategori</legend>
            @{
                if (Model.Any(x => x.urunKategorileriUstId != 0))
                {
                    <div id="kategoriAlanlariYaziAlan">
                        <span>Kayıtlı kategori bulunmamaktadır. Ürünlerinizi listelemek için lütfen kategori alanı giriniz.</span>
                    </div>
                    <div id="kategoriAlanlariButonAlan">
                        <button class="btn btn-secondary" id="kategoriButon" data-bs-target="#kategoriModal" data-bs-toggle="modal">
                            <div>
                                <span id="kategoriAlanlariButonYazi">Kategori Ekle</span>
                            </div>
                            <div>
                                <i class="bi bi-file-earmark-plus-fill" id="kategoriAlanlariButonIcon"></i>
                            </div>
                        </button>
                    </div>
                }
                else
                {
                    <div class="urunKategorileriDivAlan">
                        @foreach (var item in Model)
                        {
                            <div class="urunKategorileriAdlari">
                                @if (item.urunKategorileriUstId == 0)
                                {

                                    <span>@item.urunKategorileriKategoriAdi</span>
                                    <hr />

                                }
                                else
                                {
                                    <span>@item.urunKategorileriKategoriAdi</span>
                                    <hr />
                                }
                            </div>
                        }
                    </div>
                    <div id="kategoriAlanlariButonAlan">
                        <button class="btn btn-secondary" id="kategoriButon" data-bs-target="#kategoriAlanlariModal" data-bs-toggle="modal">
                            <div>
                                <span id="kategoriAlanlariButonYazi">Kategori Alanı Ekle</span>
                            </div>
                            <div>
                                <i class="bi bi-file-earmark-plus-fill" id="kategoriAlanlariButonIcon"></i>
                            </div>
                        </button>
                    </div>
                }
            }
        </fieldset>
    </div>
    <div class="modal fade" id="kategoriAlanlariModal" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" style="font-weight: 600; color: rgb(157, 163, 173); background-color: rgb(248, 248, 248);">
                    <h5 class="modal-title">Yeni Kategori Alanı</h5>
                    <button class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="col-md-12 pb-4 text-center kategoriAlanlariModalBodyDiv" style="font-weight: bold; color:rgb(168, 174, 185);">
                        <span>Kategori alanı, kategorilerinizi gruplayacağınız ana alan adıdır. Örğ. Elektronik > Telefon..</span>
                    </div>
                    <form class="needs-validation" novalidate id="kategoriAlanlariModalForm">
                        <div class="row g-3">
                            <div class="col-md-12">
                                <label for="kategoriAlanAdi" class="form-label">Kategori Alan Adı *</label>
                                <input id="kategoriAlanAdi" type="text" class="form-control" placeholder="Kategori Alan Adı" required>
                                <div class="invalid-feedback">
                                    Bu Alan Boş Geçilemez
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer mt-3">
                            <button class="btn btn-secondary" type="submit" id="kategoriAlanlariButonModal">Kaydet</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="kategoriModal" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" style="font-weight: 600; color: rgb(157, 163, 173); background-color: rgb(248, 248, 248);">
                    <h5 class="modal-title">Yeni Kategori</h5>
                    <button class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="col-md-12 pb-4 text-center kategoriModalBodyDiv" style="font-weight: bold; color:rgb(168, 174, 185);">
                        <span>Kategori, ürünlerinizi gruplayacağınız alan adıdır.<br/> Örğ. İos > İphone 11..</span>
                    </div>
                    <form class="needs-validation" novalidate id="kategoriModalForm">
                        <div class="row g-3">
                            <div class="col-md-12">
                                <label for="kategoriAdi" class="form-label">Kategori Adı *</label>
                                <input id="kategoriAdi" type="text" class="form-control" placeholder="Kategori Adı" required>
                                <div class="invalid-feedback">
                                    Bu Alan Boş Geçilemez
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer mt-3">
                            <button class="btn btn-secondary" type="submit" id="kategoriButonModal">Kaydet</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">

    var kategoriAlanAdKontrol = 0;

    (function () {
            'use strict'


            var forms = document.querySelectorAll('.needs-validation')


            Array.prototype.slice.call(forms)
                .forEach(function (form) {
                    form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) {
                            event.preventDefault()
                            event.stopPropagation()
                        }

                        form.classList.add('was-validated')
                    }, false)
                })
    })()

    $("#kategoriAlanlariModalForm").submit(function (event) {
        event.preventDefault();

        if ($(".urunKategorileriAlanAdlari > span").text() != "") {

            $(".urunKategorileriAlanAdlari > span").each(function (index) {

                if ($(this).text() == $("#kategoriAlanAdi").val()) {

                    kategoriAlanAdKontrol++;

                    if (kategoriAlanAdKontrol < 2) {
                        $(".kategoriAlanlariModalBodyDiv").append('<br/><span style="color: red;">Aynı İsimde Kategori Alan Adı Ekleyemezsiniz...</span>');
                    }


                    return false;

                } else {

                    var kategoriAlan = new Object();
                    kategoriAlan.urunKategorileriKategoriAdi = $("#kategoriAlanAdi").val();

                    var kategoriAlanAdiKaydet = "@Url.Action("ustKategoriEkle", "kategoriAlanlari")";

                    if (kategoriAlan.urunKategorileriKategoriAdi != "") {

                        $.ajax({
                            url: kategoriAlanAdiKaydet,
                            type: "POST",
                            data: kategoriAlan,
                            success: function (response) {

                                $("#kategoriAlanlariModal").modal('hide');

                                setTimeout(function () {

                                    $("#eeee").html(response);


                                }, 500);

                            },
                            error: function (hata, ajaxoptions, throwerror) {
                                alert("Hata :" + hata.status + " " + throwerror + " " + hata.responseText);
                            }
                        });

                        return false;
                    }
                }

            });

        }
        else {

                var kategoriAlan = new Object();
                kategoriAlan.urunKategorileriKategoriAdi = $("#kategoriAlanAdi").val();

                var kategoriAlanAdiKaydet = "@Url.Action("ustKategoriEkle", "kategoriAlanlari")";

                if (kategoriAlan.urunKategorileriKategoriAdi != "") {

                        $.ajax({
                            url: kategoriAlanAdiKaydet,
                            type: "POST",
                            data: kategoriAlan,
                            success: function (response) {


                                $("#kategoriAlanlariModal").modal('hide');

                                setTimeout(function () {

                                    $("#eeee").html(response);


                                }, 500);

                            },
                            error: function (hata, ajaxoptions, throwerror) {
                                alert("Hata :" + hata.status + " " + throwerror + " " + hata.responseText);
                            }
                        });

                }
        }
    });

    $("#kategoriModalForm").submit(function (event) {
        event.preventDefault();

        if ($(".urunKategorileriAlanAdlari > span").text() != "") {

            $(".urunKategorileriAlanAdlari > span").each(function (index) {

                if ($(this).text() == $("#kategoriAlanAdi").val()) {

                    kategoriAlanAdKontrol++;

                    if (kategoriAlanAdKontrol < 2) {
                        $(".kategoriAlanlariModalBodyDiv").append('<br/><span style="color: red;">Aynı İsimde Kategori Alan Adı Ekleyemezsiniz...</span>');
                    }


                    return false;

                } else {

                    var kategoriAlan = new Object();
                    kategoriAlan.urunKategorileriKategoriAdi = $("#kategoriAlanAdi").val();

                    var kategoriAlanAdiKaydet = "@Url.Action("ustKategoriEkle", "kategoriAlanlari")";

                    if (kategoriAlan.urunKategorileriKategoriAdi != "") {

                        $.ajax({
                            url: kategoriAlanAdiKaydet,
                            type: "POST",
                            data: kategoriAlan,
                            success: function (response) {

                                $("#kategoriAlanlariModal").modal('hide');

                                setTimeout(function () {

                                    $("#eeee").html(response);


                                }, 500);

                            },
                            error: function (hata, ajaxoptions, throwerror) {
                                alert("Hata :" + hata.status + " " + throwerror + " " + hata.responseText);
                            }
                        });

                        return false;
                    }
                }

            });

        }
        else {

                var kategoriAlan = new Object();
                kategoriAlan.urunKategorileriKategoriAdi = $("#kategoriAlanAdi").val();

                var kategoriAlanAdiKaydet = "@Url.Action("ustKategoriEkle", "kategoriAlanlari")";

                if (kategoriAlan.urunKategorileriKategoriAdi != "") {

                        $.ajax({
                            url: kategoriAlanAdiKaydet,
                            type: "POST",
                            data: kategoriAlan,
                            success: function (response) {


                                $("#kategoriAlanlariModal").modal('hide');

                                setTimeout(function () {

                                    $("#eeee").html(response);


                                }, 500);

                            },
                            error: function (hata, ajaxoptions, throwerror) {
                                alert("Hata :" + hata.status + " " + throwerror + " " + hata.responseText);
                            }
                        });

                }
        }
    });

</script>